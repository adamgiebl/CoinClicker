window.addEventListener("load",start);const container=document.querySelector("#game_elements"),heartsContainer=document.querySelector("#hearts"),coinsContainer=document.querySelector("#coins"),screen=document.querySelector("#screen");let allHearts=[],hearts=3,coins=0,numberOfHearts=3,speeds=["speed1","speed2","speed3"];const types={HEART:"heart",COIN:"coin",BOMB:"bomb"};function start(){for(let e=0;e<numberOfHearts;e++)heartsContainer.innerHTML+='<div class="heart"></div>';allHearts=document.querySelectorAll(".heart"),generateElements(types.BOMB,4),generateElements(types.COIN,7),generateElements(types.HEART,1)}function updateHearts(){allHearts.forEach(e=>{e.classList.add("broken")});for(let e=0;e<hearts;e++)allHearts[e].classList.remove("broken")}function generateElements(e,t){for(let s=0;s<t;s++){const t=document.createElement("div"),a=e===types.BOMB?"explode":"zoom";t.classList.add(`${e}_container`,"falling"),t.innerHTML='<div class="sprite"></div>',t.dataset.id=s,t.dataset.type=e,t.randomize=function(){this.addEventListener("click",this.clicked),this.style.left=Math.floor(100*Math.random())+"vw",this.classList.remove(...speeds),this.classList.add("speed"+(Math.floor(Math.random()*speeds.length)+1))},t.restart=function(){this.children[0].classList.remove(a),this.classList.remove("pause"),this.classList.remove("falling"),this.offsetHeight,this.classList.add("falling"),this.addEventListener("click",this.clicked),this.randomize()},t.clicked=function(){switch(e){case types.BOMB:1===hearts?window.location.reload():hearts--,updateHearts();break;case types.COIN:coins++,coinsContainer.innerText=coins;break;case types.HEART:3!==hearts&&hearts++,updateHearts()}this.removeEventListener("click",this.clicked),this.classList.add("pause"),this.children[0].classList.add(a),"explode"===a&&screen.classList.add("shake"),requestAnimationFrame(()=>{"explode"===a||this.children[0].addEventListener("animationend",()=>{"explode"===a?screen.classList.remove("shake"):(this.children[0].classList.remove("zoom"),this.classList.remove("pause"))})})},t.randomize(),t.addEventListener("mousedown",t.clicked),t.addEventListener("animationend",t.restart),container.appendChild(t)}}